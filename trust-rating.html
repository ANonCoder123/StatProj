<!DOCTYPE html>
<html>
<head>
  <title>Trust Rating</title>
</head>
<body>
  <h1>Trust Rating</h1>
  <p>Please rate each person in your group on a scale from 1 to 10 based on how much you trust them, with 10 being the most and 1 being the least.</p>
  
  <form id="trustRatingForm">
    <!-- Add input fields for rating each person dynamically -->
    <div id="ratingFields"></div>
    
    <br>
    <input type="submit" value="Submit">
  </form>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script>
    // Initialize Firebase with your configuration
    const firebaseConfig = {
      apiKey: "<YOUR_API_KEY>",
      authDomain: "<YOUR_AUTH_DOMAIN>",
      databaseURL: "<YOUR_DATABASE_URL>",
      projectId: "<YOUR_PROJECT_ID>",
      storageBucket: "<YOUR_STORAGE_BUCKET>",
      messagingSenderId: "<YOUR_MESSAGING_SENDER_ID>",
      appId: "<YOUR_APP_ID>",
      measurementId: "<YOUR_MEASUREMENT_ID>"
    };

    firebase.initializeApp(firebaseConfig);

    // Get a reference to the Firebase database
    const database = firebase.database();

    // Retrieve the group and period from the URL query parameters
    const urlParams = new URLSearchParams(window.location.search);
    const period = urlParams.get("period");

    // Retrieve the names of people from the same period
    database.ref("participants")
      .orderByChild("period")
      .equalTo(period)
      .once("value")
      .then(function(snapshot) {
        const participants = snapshot.val();
        if (participants) {
          const personNames = Object.values(participants).map(participant => participant.name);
          generateRatingFields(personNames);
        } else {
          console.log("No participants found for the specified period.");
        }
      })
      .catch(function(error) {
        console.log("Error retrieving participants:", error);
      });

    // Generate input fields for rating each person
    function generateRatingFields(names) {
      const ratingFieldsContainer = document.getElementById("ratingFields");
      ratingFieldsContainer.innerHTML = ""; // Clear any existing fields

      for (let i = 0; i < names.length; i++) {
        const label = document.createElement("label");
        label.innerHTML = "Person " + (i + 1) + " (" + names[i] + "): ";
        
        const input = document.createElement("input");
        input.type = "number";
        input.min = 1;
        input.max = 10;
        input.id = "rating" + (i + 1);
        input.required = true;

        const lineBreak = document.createElement("br");

        ratingFieldsContainer.appendChild(label);
        ratingFieldsContainer.appendChild(input);
        ratingFieldsContainer.appendChild(lineBreak);
      }
    }

    // Handle form submission
    document.getElementById("trustRatingForm").addEventListener("submit", function(event) {
      event.preventDefault();

      // Retrieve ratings for each person
      const ratings = [];
      const ratingInputs = document.querySelectorAll('input[type="number"]');
      ratingInputs.forEach(function(input) {
        ratings.push(input.value);
      });

      // Perform the write operation to store the ratings
      firebase.database()
        .ref("ratings")
        .push({
          period: period,
          ratings: ratings
    })
    .then(() => {
      console.log("Ratings stored successfully");
      // Replace "thank-you.html" with the desired destination page
      window.location.href = "thank-you.html";
    })
    .catch((error) => {
      console.error("Error storing ratings:", error);
    });
});
  </script>
</body>
</html>
```
