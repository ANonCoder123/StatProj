<!DOCTYPE html>
<html>
<head>
  <title>Experiment</title>
</head>
<body>
  <h1>Participant Registration</h1>
  <form id="registrationForm">
    <label for="name">Name:</label>
    <input type="text" id="name" required><br><br>

    <label for="age">Age:</label>
    <input type="number" id="age" required><br><br>

    <label for="gender">Gender:</label>
    <input type="text" id="gender" required><br><br>

    <label for="race">Race/Ethnicity:</label>
    <select id="race" required>
      <option value="American Indian or Alaskan Native">American Indian or Alaskan Native</option>
      <option value="Asian / Pacific Islander">Asian / Pacific Islander</option>
      <option value="Black or African American">Black or African American</option>
      <option value="Hispanic">Hispanic</option>
      <option value="White / Caucasian">White / Caucasian</option>
      <option value="Multiple ethnicity/ Other">Multiple ethnicity/ Other (please specify)</option>
    </select><br><br>

    <label for="period">Period:</label>
    <input type="number" id="period" min="1" max="10" required><br><br>

    <input type="submit" value="Submit">
  </form>

  <!-- Include the Firebase JavaScript SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  
  <script>
    // Initialize Firebase with your configuration
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      databaseURL: "YOUR_DATABASE_URL",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID",
      measurementId: "YOUR_MEASUREMENT_ID"
    };

    firebase.initializeApp(firebaseConfig);

    // Get a reference to the Firebase database
    const database = firebase.database();

    document.getElementById("registrationForm").addEventListener("submit", async function(event) {
      event.preventDefault();

      // Retrieve form values
      const name = document.getElementById("name").value;
      const age = document.getElementById("age").value;
      const gender = document.getElementById("gender").value;
      const race = document.getElementById("race").value;
      const period = document.getElementById("period").value;

      try {
        // Store the participant data in Firebase
        const user = firebase.auth().currentUser;
        const token = await user.getIdToken();

        await firebase.database().ref("statpsych-9ff2a/participants").push().set({
          name: name,
          age: age,
          gender: gender,
          race: race,
          period: period
        }, { headers: { Authorization: `Bearer ${token}` } });

        // Redirect to the trust rating questions page for the specific period
        window.location.href = "trust-rating.html?period=" + period;
      } catch (error) {
        console.log("Error storing participant data:", error);
      }
    });
  </script>
</body>
</html>
